### B-树，即为B树，多路平衡查找树。

因为B树的原英文名称为B-tree，而国内很多人喜欢把B-tree译作B-树，其实，B-tree就是指的B树。

*ceil代表向上取整

阶：B-树中所有结点中孩子结点个数的最大值成为B-树的阶，通常用m表示(一般要求m>=3)。

### 一棵m阶B-树或者是一棵空树，满足以下条件：

1）每个结点最多有m个分支（子树），即至多含有m-1个关键字；

2）若根节点不是终端节点，则至少有两颗子树

3）除根节点外的所有非叶节点至少含有ceil(m/2)颗子树（分支）,至少含有ceil(m/2)-1个关键字

4）所有的叶节点都出现在同一层次上，并且不带信息（查找失败落在的位置）

例如5阶B树，每个节点最多还有5个分支，最多4个关键字，除根节点外的所有非叶节点至少含有3个分支，至少2个关键字

### M阶B树的核心特性：

1）根节点的子树属于[2,m],关键字数属于[1,m-1],其他结点的子树数属于[[m/2],m];关键字书属于[[m/2]-1,m-1]

2）对任一节点，其所有子树高度都相同

3）关键字的值：子树0<关键字1<子树1<关键字2

含有N个关键字的M阶B树，最小高度h>=logm(n+1),最大高度

第h+1层共有叶子结点 C = $ceil(m/2)^{h-1}* 2$, M = ceil(m/2)

n个关键字的B树必有n+1叶子结点，则n+1>=C,即h <= logM((n+1)/2) + 1

### 对比B树和B+树

M阶B+树

1）结点中的n个关键字对应n棵子树

2）根关键字数属于[1,m]，其他结点的关键字属于[ceil(m/2),m-1]

3）在B+树中，叶结点包含全部关键字，非叶节点中出现过的关键字也会出现在叶结点中

4）在B+树中，叶结点包含信息，所有非叶节点仅仅起索引作用，非叶节点中每个索引项

只含有对应子树的最大关键字和指向该子树的指针，不含有该关键字对应记录的存储地址。

M阶B树

1）结点中的n个关键字对应n+1棵子树

2）根关键字数属于[1,m-1]，其他结点的关键字属于[ceil(m/2)-1,m-1]

3）在B树中，各节点中包含的关键字是不重复的



|         | m阶B树                               | m阶B+树                            |
| ------- | ---------------------------------- | -------------------------------- |
| 类比      | 二叉查找树的进化--m叉查找树                    | 分块查询的进化--多级分块查找                  |
| 关键字与分叉  | n个关键字对应n+1个分叉（子树）                  | n个关键字对应n个分叉                      |
| 节点包含的信息 | 所有节点中都包含记录的信息                      | 只有最下层叶子结点才包含记录的信息（可使树更矮）         |
| 查找方式    | 不支持顺序查找。查找成功时，可能停在任意一层节点，查找速度不稳定   | 支持顺序查找，查找成功或者失败都会到达最下一层节点，查找速度稳定 |
| 相同点     | 除根节点外，最少ceil(m/2)个分叉任何一个节点的子树都要一样高 |                                  |